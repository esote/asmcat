TODO:
	Return 1 on read and write failures
